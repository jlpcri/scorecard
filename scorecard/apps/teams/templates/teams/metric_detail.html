{% extends 'core/base.html' %}

{% block title %} Quality Innovation Metric {% endblock %}

{% block body %}
    <div class="container">
        <h2>{{ metric.functional_group.name }} Metric Detail - {{ metric.created|date }}</h2>
        <form action="{% url 'teams:metric_edit' metric.id %}?key={{ metric.functional_group.key }}" method="post">
            {% if metric.functional_group.key == 'TL' %}  <!-- Test Lab separate-->
                <legend style="margin-top: 30px;">Human Resource</legend>
                <div class="row">
                    <div class="col-sm-2"><label>Staffs</label></div>
                    <div class="col-sm-2"><label>Openings</label></div>
                    <div class="col-sm-2"><label>Contractors</label></div>
                    <div class="col-sm-3"><label>Functional Group</label></div>
                </div>
                <div class="row">
                    <div class="col-sm-2">{{ form.staffs }}</div>
                    <div class="col-sm-2">{{ form.openings }}</div>
                    <div class="col-sm-2">{{ form.contractors }}</div>
                    <div class="col-sm-3">{{ form.functional_group }}</div>
                </div>
                <legend style="margin-top: 30px;">Throughput</legend>
                <div class="row">
                    <div class="col-sm-2"><label>Tickets Received</label></div>
                    <div class="col-sm-2"><label>Tickets Closed</label></div>
                    <div class="col-sm-2"><label>Virtual Machines</label></div>
                    <div class="col-sm-2"><label>Physical Machines</label></div>
                </div>
                <div class="row">
                    <div class="col-sm-2">{{ form.tickets_received }}</div>
                    <div class="col-sm-2">{{ form.tickets_closed }}</div>
                    <div class="col-sm-2">{{ form.virtual_machines }}</div>
                    <div class="col-sm-2">{{ form.physical_machines }}</div>
                </div>
                <legend style="margin-top: 30px;">Costs</legend>
                <div class="row">
                    <div class="col-sm-2"><label>Power Consumption UPS A</label></div>
                    <div class="col-sm-2"><label>Power Consumption UPS A</label></div>
                    <div class="col-sm-2"><label>License Cost</label></div>
                </div>
                <div class="row">
                    <div class="col-sm-2">{{ form.power_consumption_ups_a }}</div>
                    <div class="col-sm-2">{{ form.power_consumption_ups_b }}</div>
                    <div class="col-sm-2">{{ form.license_cost }}</div>
                </div>
            {% else %} <!-- For PQ, QA, TE, RE, QI -->
                <legend style="margin-top: 30px;">Human Resource</legend>
                <div class="row">
                    <div class="col-sm-2"><label>Staffs</label></div>
                    <div class="col-sm-2"><label>Openings</label></div>
                    <div class="col-sm-2"><label>Contractors</label></div>
                    <div class="col-sm-3"><label>Functional Group</label></div>
                </div>
                <div class="row">
                    <div class="col-sm-2">{{ form.staffs }}</div>
                    <div class="col-sm-2">{{ form.openings }}</div>
                    <div class="col-sm-2">{{ form.contractors }}</div>
                    <div class="col-sm-3">{{ form.functional_group }}</div>
                </div>

                <legend style="margin-top: 30px;">Throughput</legend>
                {% if metric.functional_group.key == 'QI' %}  <!-- Throughput -->
                    <div class="row">
                        <div class="col-sm-2"><label>Backlog Story</label></div>
                        <div class="col-sm-2"><label>Story Points Prep</label></div>
                        <div class="col-sm-2"><label>Story Points Execute</label></div>
                        <div class="col-sm-2"><label>Unit Tests Dev</label></div>
                        <div class="col-sm-2"><label>Unit Tests Cover</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">{{ form.story_points_backlog }}</div>
                        <div class="col-sm-2">{{ form.story_points_prep }}</div>
                        <div class="col-sm-2">{{ form.story_points_execution }}</div>
                        <div class="col-sm-2">{{ form.unit_tests_dev }}</div>
                        <div class="col-sm-2">{{ form.unit_tests_coverage }}</div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2"><label>Document Cover</label></div>
                        <div class="col-sm-2"><label>Defects in Dev</label></div>
                        <div class="col-sm-2"><label>Elicitation Analysis</label></div>
                        <div class="col-sm-2"><label>Revisions</label></div>
                        <div class="col-sm-2"><label>Active Projects</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">{{ form.documentation_coverage }}</div>
                        <div class="col-sm-2">{{ form.defects_in_dev }}</div>
                        <div class="col-sm-2">{{ form.elicitation_analysis_time }}</div>
                        <div class="col-sm-2">{{ form.revisions }}</div>
                        <div class="col-sm-2">{{ form.active_projects }}</div>
                    </div>
                {% elif metric.functional_group.key == 'RE' %}
                    <div class="row">
                        <div class="col-sm-2"><label>Backlog</label></div>
                        <div class="col-sm-2"><label>Active Projects</label></div>
                        <div class="col-sm-2"><label>Team Initiatives</label></div>
                        <div class="col-sm-2"><label>Elicitation Analysis</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">{{ form.backlog }}</div>
                        <div class="col-sm-2">{{ form.active_projects }}</div>
                        <div class="col-sm-2">{{ form.team_initiative }}</div>
                        <div class="col-sm-2">{{ form.elicitation_analysis_time }}</div>
                    </div>
                {% else %}  <!-- For TE, QA, PQ -->
                    <div class="row">
                        <div class="col-sm-2"><label>Team Initiatives</label></div>
                        <div class="col-sm-2"><label>Tickets Backlog</label></div>
                        <div class="col-sm-2"><label>Tickets Prep</label></div>
                        <div class="col-sm-2"><label>Tickets Execution</label></div>
                        <div class="col-sm-2"><label>Tickets Closed</label></div>
                        <div class="col-sm-2"><label>Projects Backlog</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">{{ form.team_initiative }}</div>
                        <div class="col-sm-2">{{ form.ticket_backlog }}</div>
                        <div class="col-sm-2">{{ form.ticket_prep }}</div>
                        <div class="col-sm-2">{{ form.ticket_execution }}</div>
                        <div class="col-sm-2">{{ form.ticket_closed }}</div>
                        <div class="col-sm-2">{{ form.project_backlog }}</div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2"><label>Projects Prep</label></div>
                        <div class="col-sm-2"><label>Projects Execution</label></div>
                        <div class="col-sm-2"><label>Projects Closed</label></div>
                        <div class="col-sm-2"><label>Manual TCs Dev</label></div>
                        <div class="col-sm-2"><label>Manual TC Dev Time</label></div>
                        <div class="col-sm-2"><label>Manual Tcs Execution</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">{{ form.project_prep }}</div>
                        <div class="col-sm-2">{{ form.project_execution }}</div>
                        <div class="col-sm-2">{{ form.project_closed }}</div>
                        <div class="col-sm-2">{{ form.tc_manual_dev }}</div>
                        <div class="col-sm-2">{{ form.tc_manual_dev_time }}</div>
                        <div class="col-sm-2">{{ form.tc_manual_execution }}</div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2"><label>Auto TCs Dev</label></div>
                        <div class="col-sm-2"><label>Auto TCs Dev Time</label></div>
                        <div class="col-sm-2"><label>Auto Tcs Execution</label></div>
                        <div class="col-sm-2"><label>Auto Tcs ExecTime</label></div>
                        <div class="col-sm-2"><label>Manual Tcs ExecutTime</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">{{ form.tc_auto_dev }}</div>
                        <div class="col-sm-2">{{ form.tc_auto_dev_time }}</div>
                        <div class="col-sm-2">{{ form.tc_auto_execution }}</div>
                        <div class="col-sm-2">{{ form.tc_auto_execution_time }}</div>
                        <div class="col-sm-2">{{ form.tc_manual_execution_time }}</div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2"><label>Auto Footprint Dev</label></div>
                        <div class="col-sm-2"><label>Auto Footprint Execut</label></div>
                        <div class="col-sm-2"><label>Avg Throughput</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">
                            <input class="gentle" id="auto_footprint_dev" value="{% widthratio metric.auto_footprint_dev_age 1 100 %}%" disabled/>
                        </div>
                        <div class="col-sm-2">
                            <input class="gentle" id="auto_footprint_execution" value="{% widthratio metric.auto_footprint_execution_age 1 100 %}%" disabled/>
                        </div>
                        <div class="col-sm-2">
                            <input class="gentle" id="avg_throughput" value="{{ metric.avg_throughput|floatformat:2 }}" disabled/>
                        </div>
                    </div>
                {% endif %}

                <legend style="margin-top: 30px;">Quality</legend>
                {% if metric.functional_group.key == 'QI' %}  <!-- Quality -->
                    <div class="row">
                        <div class="col-sm-2"><label>SLAs Met</label></div>
                        <div class="col-sm-2"><label>Delays Intro Time</label></div>
                        <div class="col-sm-2"><label>SDIs not Prevented</label></div>
                        <div class="col-sm-4"><label>UAT Defects not Prevented</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">{{ form.slas_met }}</div>
                        <div class="col-sm-2">{{ form.delays_introduced_time }}</div>
                        <div class="col-sm-2">{{ form.sdis_not_prevented }}</div>
                        <div class="col-sm-4">{{ form.uat_defects_not_prevented }}</div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2"><label>Resource Swap</label></div>
                        <div class="col-sm-2"><label>Escalations</label></div>
                        <div class="col-sm-2"><label>Rework Introduced</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">{{ form.resource_swap }}</div>
                        <div class="col-sm-2">{{ form.escalations }}</div>
                        <div class="col-sm-2">{{ form.rework_introduced_time }}</div>
                    </div>
                {% elif metric.functional_group.key == 'RE' %}
                    <div class="row">
                        <div class="col-sm-2"><label>Revisions</label></div>
                        <div class="col-sm-2"><label>Rework Introduced</label></div>
                        <div class="col-sm-2"><label>SLAs Met</label></div>
                        <div class="col-sm-2"><label>SLAs Missed</label></div>
                        <div class="col-sm-2"><label>Delays Intro Time</label></div>
                        <div class="col-sm-2"><label>Escalations</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">{{ form.revisions }}</div>
                        <div class="col-sm-2">{{ form.rework_introduced_time }}</div>
                        <div class="col-sm-2">{{ form.slas_met }}</div>
                        <div class="col-sm-2">{{ form.slas_missed }}</div>
                        <div class="col-sm-2">{{ form.delays_introduced_time }}</div>
                        <div class="col-sm-2">{{ form.escalations }}</div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2"><label>Avg Throughput</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">
                            <input class="gentle" id="avg_throughput" value="{{ metric.avg_throughput }}" disabled/>
                        </div>
                    </div>
                {% else %}
                    <div class="row">
                        <div class="col-sm-2"><label>SLAs Met</label></div>
                        <div class="col-sm-2"><label>Delays Intro Time</label></div>
                        <div class="col-sm-2"><label>Defects Caught</label></div>
                        <div class="col-sm-3"><label>UAT defects not prevented</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">{{ form.slas_met }}</div>
                        <div class="col-sm-2">{{ form.delays_introduced_time }}</div>
                        <div class="col-sm-2">{{ form.defect_caught }}</div>
                        <div class="col-sm-3">{{ form.uat_defects_not_prevented }}</div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2"><label>SDIs not prevented</label></div>
                        <div class="col-sm-2"><label>Resource Swap</label></div>
                        <div class="col-sm-2"><label>Escalations</label></div>
                        <div class="col-sm-2"><label>Standards Violated</label></div>
                        <div class="col-sm-2"><label>Escalations</label></div>
                        <div class="col-sm-2"><label>Rework Introduced</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">{{ form.sdis_not_prevented }}</div>
                        <div class="col-sm-2">{{ form.resource_swap }}</div>
                        <div class="col-sm-2">{{ form.escalations }}</div>
                        <div class="col-sm-2">{{ form.standards_violated }}</div>
                        <div class="col-sm-2">{{ form.escalations }}</div>
                        <div class="col-sm-2">{{ form.rework_introduced_time }}</div>
                    </div>
                {% endif %}

                <legend style="margin-top: 30px;">Efficiency</legend>
                {% if metric.functional_group.key == 'QI' %}  <!-- Efficiency -->
                    <div class="row">
                        <div class="col-sm-2"><label>Average Team Size</label></div>
                        <div class="col-sm-2"><label>Overtime Weekday</label></div>
                        <div class="col-sm-2"><label>Overtime Weekend</label></div>
                        <div class="col-sm-2"><label>Average Throughput</label></div>
                        <div class="col-sm-2"><label>Rework Time</label></div>
                        <div class="col-sm-2"><label>Resource Swap time</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">{{ form.avg_team_size }}</div>
                        <div class="col-sm-2">{{ form.overtime_weekday }}</div>
                        <div class="col-sm-2">{{ form.overtime_weekend }}</div>
                        <div class="col-sm-2">
                            <input class="gentle" id="avg_throughput_qi" value="{{ metric.avg_throughput }}" disabled/>
                        </div>
                        <div class="col-sm-2">{{ form.rework_time }}</div>
                        <div class="col-sm-2">{{ form.resource_swap_time }}</div>
                    </div>
                {% elif metric.functional_group.key == 'RE' %}
                    <div class="row">
                        <div class="col-sm-2"><label>Gross Available</label></div>
                        <div class="col-sm-2"><label>Efficiency</label></div>
                        <div class="col-sm-2"><label>Overtime Weekday</label></div>
                        <div class="col-sm-2"><label>Overtime Weekend</label></div>
                        <div class="col-sm-2"><label>Rework External</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">
                            <input class="gentle" id="gross_available" value="{{ metric.gross_available_time }}" disabled/>
                        </div>
                        <div class="col-sm-2">
                            <input class="gentle" id="id_efficiency" value="{% widthratio metric.efficiency 1 100 %}%" disabled/>
                        </div>
                        <div class="col-sm-2">{{ form.overtime_weekday }}</div>
                        <div class="col-sm-2">{{ form.overtime_weekend }}</div>
                        <div class="col-sm-2">{{ form.rework_external_time }}</div>
                    </div>
                {% else %}
                    <div class="row">
                        <div class="col-sm-2"><label>Average Team Size</label></div>
                        <div class="col-sm-2"><label>Average TimeFrame</label></div>
                        <div class="col-sm-2"><label>Overtime Weekday</label></div>
                        <div class="col-sm-2"><label>Overtime Weekend</label></div>
                        <div class="col-sm-2"><label>Rework Time</label></div>
                        <div class="col-sm-2"><label>Resource Swap time</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">{{ form.avg_team_size }}</div>
                        <div class="col-sm-2">{{ form.avg_time_frame }}</div>
                        <div class="col-sm-2">{{ form.overtime_weekday }}</div>
                        <div class="col-sm-2">{{ form.overtime_weekend }}</div>
                        <div class="col-sm-2">{{ form.rework_time }}</div>
                        <div class="col-sm-2">{{ form.resource_swap_time }}</div>
                    </div>

                    <div class="row">
                        <div class="col-sm-2"><label>Active Tickets</label></div>
                        <div class="col-sm-2"><label>Active Projects</label></div>
                        <div class="col-sm-2"><label>AutoExec Time</label></div>
                        <div class="col-sm-2"><label>GrossAvai time</label></div>
                        <div class="col-sm-2"><label>Efficiency</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">
                            <input class="gentle" id="active_tickets" value="{{ metric.active_tickets }}" disabled/>
                        </div>
                        <div class="col-sm-2">
                            <input class="gentle" id="active_projects" value="{{ metric.active_projects }}" disabled/>
                        </div>
                        <div class="col-sm-2">
                            <input class="gentle" id="auto_and_execution_time" value="{{ metric.auto_and_execution_time }}" disabled/>
                        </div>
                        <div class="col-sm-2">
                            <input class="gentle" id="gross_available_time" value="{{ metric.gross_available_time }}" disabled/>
                        </div>
                        <div class="col-sm-2">
                            <input class="gentle" id="id_test_efficiency" value="{% widthratio metric.efficiency 1 100 %}%" disabled/>
                        </div>
                    </div>
                {% endif %}

                <legend style="margin-top: 30px;">Costs</legend>
                {% if metric.functional_group.key == 'RE' %} <!-- Cost and Usage-->
                    <div class="row">
                        <div class="col-sm-2"><label>Travel Cost</label></div>
                        <div class="col-sm-2"><label>Operational Cost</label></div>
                        <div class="col-sm-2"><label>Rework External Cost</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">{{ form.travel_cost }}</div>
                        <div class="col-sm-2">
                            <input class="gentle" id="operational_cost" value="{{ metric.operational_cost }}" disabled/>
                        </div>
                        <div class="col-sm-2">
                            <input class="gentle" id="rework_external_cost" value="{{ metric.rework_external_cost }}" disabled/>
                        </div>
                    </div>
                {% elif metric.functional_group.key == 'QI' %} <!-- QI Cost and Usage -->
                    <div class="row">
                        <div class="col-sm-2"><label>License Cost</label></div>
                        <div class="col-sm-2"><label>Operational Cost</label></div>
                        <div class="col-sm-2"><label>Total Cost</label></div>
                        <div class="col-sm-2"><label>Other Savings</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">{{ form.license_cost }}</div>
                        <div class="col-sm-2">
                            <input class="gentle" id="operational_cost" value="{{ metric.operational_cost|floatformat:2 }}" disabled/>
                        </div>
                        <div class="col-sm-2">
                            <input class="gentle" id="total_cost" value="{{ metric.total_operational_cost }}" disabled />
                        </div>
                        <div class="col-sm-2">{{ form.other_savings }}</div>
                    </div>
                    <!-- Usage -->
                    <legend style="margin-top: 30px;">Usage</legend>
                    <div class="row">
                        <div class="col-sm-2"><label>Pheme Manual Tests</label></div>
                        <div class="col-sm-2"><label>Pheme Auto Tests</label></div>
                        <div class="col-sm-2"><label>Visilog TXL Parsed</label></div>
                        <div class="col-sm-2"><label>Visilog TXL Violation</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">{{ form.pheme_manual_tests }}</div>
                        <div class="col-sm-2">{{ form.pheme_auto_tests }}</div>
                        <div class="col-sm-2">{{ form.visilog_txl_parsed }}</div>
                        <div class="col-sm-2">{{ form.visilog_txl_schema_violation }}</div>
                    </div>
                {% else %} <!-- PQ, QA, TE cost -->
                    <div class="row">
                        <div class="col-sm-2"><label>License Cost</label></div>
                        <div class="col-sm-2"><label>Operational Cost</label></div>
                        <div class="col-sm-2"><label>Total Cost</label></div>
                        <div class="col-sm-2"><label>Automation Savings</label></div>
                        <div class="col-sm-2"><label>Other Savings</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">{{ form.license_cost }}</div>
                        <div class="col-sm-2">
                            <input class="gentle" id="operational_cost" value="{{ metric.operational_cost }}" disabled/>
                        </div>
                        <div class="col-sm-2">
                            <input class="gentle" id="total_cost" value="{{ metric.total_operational_cost }}" disabled />
                        </div>
                        <div class="col-sm-2">
                            <input class="gentle" id="auto_savings" value="{{ metric.auto_savings }}" disabled/>
                        </div>
                        <div class="col-sm-2">{{ form.other_savings }}</div>
                    </div>
                {% endif %}
            {% endif %}


            {% csrf_token %}
            <div class="row" style="margin-top: 30px; margin-bottom: 50px;">
                <div class="col-md-4"></div>
                <div class="col-md-2">
                    <input id="qi_edit" class="btn btn-primary" style="width: 100%;" type="submit" value="Save Metric">
                </div>
                <div class="col-md-2">
                    <a href="{% url 'teams:teams' %}" class="btn btn-default" style="width: 100%;">Cancel</a>
                </div>
            </div>
        </form>
    </div>
{% endblock %}

{% block footer %}
    <script>
        {% include 'teams/metric_detail.js' %}
    </script>
{% endblock %}