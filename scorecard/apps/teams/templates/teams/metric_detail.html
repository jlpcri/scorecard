{% extends 'core/base.html' %}
{% load team_extras %}

{% block title %} Quality Innovation Metric {% endblock %}

{% block body %}
    <div class="container">
        <div class="row">
            <div class="col-sm-8">
                <h2>{{ metric.functional_group.name }}{% if metric.subteam and metric.subteam.name != 'Unified'%} - {{ metric.subteam.name }}{% endif %}, {{ metric.created|date:'Y-m-d' }}</h2>
            </div>
            <div class="col-sm-2">
                <br>
                <input id="collect_data_key" value="{{ metric.functional_group.abbreviation }}" hidden>
                <input id="collect_data_date" value="{{ metric.created|date:'Y-m-d' }}" hidden>
                {% if metric.subteam %}
                    <input id="collect_data_button" class="btn btn-primary" style="width:100%;" type="button" value="Collect Data">
                {% endif %}
            </div>
        </div>
        <form action="{% url 'teams:metric_edit' metric.id %}?key={{ metric.functional_group.abbreviation }}" method="post">
            <input name="subteam" value="{{ metric.subteam.id }}" type="hidden">
            {% if metric.functional_group.key == 'TL' %}  <!-- Test Lab separate-->
                <legend style="margin-top: 30px;">Human Resource</legend>
                <div class="row">
                    <div class="col-sm-2"><label>Staffs</label></div>
                    <div class="col-sm-2"><label>Openings</label></div>
                    <div class="col-sm-2"><label>Contractors</label></div>
                    <div class="col-sm-2"><label>Compliments</label></div>
                    <div class="col-sm-2"><label>Complaints</label></div>
                </div>
                <div class="row">
                    <div class="col-sm-2">{{ form.staffs }}</div>
                    <div class="col-sm-2">{{ form.openings }}</div>
                    <div class="col-sm-2">{{ form.contractors }}</div>
                    <div class="col-sm-2">
                        <input id="id_compliments" name="compliments"
                            {% if automation_data.compliments %} value="{{ automation_data.compliments }}" class="gentle" {% else %} value="{{ metric.compliments }}" {% endif %}>
                    </div>
                    <div class="col-sm-2">
                        <input id="id_complaints" name="complaints"
                            {% if automation_data.complaints %} value="{{ automation_data.complaints }}" class="gentle" {% else %} value="{{ metric.complaints }}" {% endif %}>
                    </div>
                </div>

                <legend style="margin-top: 30px;">Throughput</legend>
                <div class="row">
                    <div class="col-sm-2"><label>Tickets Received</label></div>
                    <div class="col-sm-2"><label>Tickets Closed</label></div>
                    <div class="col-sm-2"><label>Virtual Machines</label></div>
                    <div class="col-sm-2"><label>Physical Machines</label></div>
                    <div class="col-sm-2"><label>Monitor Machines</label></div>
                </div>
                <div class="row">
                    <div class="col-sm-2">
                        <input id="id_tickets_received" name="tickets_received"
                            {% if automation_data.tickets_received%}
                               value="{{ automation_data.tickets_received}}" class="gentle"
                            {% else %}
                               value="{{ metric.tickets_received}}"
                            {% endif %}>
                    </div>
                    <div class="col-sm-2">{{ form.tickets_closed }}</div>
                    <div class="col-sm-2">
                        <input id="id_virtual_machines" name="virtual_machines"
                            {% if automation_data.virtual_machines%}
                               value="{{ automation_data.virtual_machines}}" class="gentle"
                            {% else %}
                               value="{{ metric.virtual_machines}}"
                            {% endif %}>
                    </div>
                    <div class="col-sm-2">
                        <input id="id_physical_machines" name="physical_machines"
                            {% if automation_data.physical_machines%}
                               value="{{ automation_data.physical_machines}}" class="gentle"
                            {% else %}
                               value="{{ metric.physical_machines}}"
                            {% endif %}>
                    </div>
                    <div class="col-sm-2">
                        <input id="id_monitor_machines" name="monitor_machines"
                            {% if automation_data.monitor_machines%}
                               value="{{ automation_data.monitor_machines}}" class="gentle"
                            {% else %}
                               value="{{ metric.monitor_machines}}"
                            {% endif %}>
                    </div>
                </div>

                <legend style="margin-top: 30px;">Quality</legend>
                <div class="row">
                    <div class="col-sm-2"><label>Builds Submitted</label></div>
                    <div class="col-sm-2"><label>Builds Accepted</label></div>
                    <div class="col-sm-2"><label>Builds Rejected</label></div>
                    <div class="col-sm-2"><label>Platform Drift Violations</label></div>
					<div class="col-sm-2"><label>Updates Install Docs</label></div>
                </div>
                <div class="row">
                    <div class="col-sm-2">
                        <input id="id_builds_submitted" name="builds_submitted"
                            {% if automation_data.builds_submitted %} value="{{ automation_data.builds_submitted }}" class="gentle" {% else %} value="{{ metric.builds_submitted }}" {% endif %}>
                    </div>
                    <div class="col-sm-2">
                        <input id="id_builds_accepted" name="builds_accepted"
                            {% if automation_data.builds_accepted %} value="{{ automation_data.builds_accepted }}" class="gentle" {% else %} value="{{ metric.builds_accepted }}" {% endif %}>
                    </div>
					<div class="col-sm-2">
                        <input class="gentle" id="id_builds_rejected" name="builds_rejected" title="Builds Submitted - Builds Accepted"
                            {% if calculate_data.builds_rejected %} value="{{ calculate_data.builds_rejected }}" {% else %} value="{{ metric.builds_rejected }}" {% endif %} disabled/>
                    </div>
					<div class="col-sm-2">
                        <input id="id_platform_drift_violations" name="platform_drift_violations"
                            {% if automation_data.platform_drift_violations %} value="{{ automation_data.platform_drift_violations }}" class="gentle" {% else %} value="{{ metric.platform_drift_violations }}" {% endif %}>
                    </div>
					<div class="col-sm-2">
                        <input id="id_updates_install_docs" name="updates_install_docs"
                            {% if automation_data.updates_install_docs %} value="{{ automation_data.updates_install_docs }}" class="gentle" {% else %} value="{{ metric.updates_install_docs }}" {% endif %}>
                    </div>
                </div>

                <legend style="margin-top: 30px;">Efficiency</legend>
                <div class="row">
                    <div class="col-sm-2"><label>Administration Time</label></div>
                    <div class="col-sm-2"><label>Project Time</label></div>
                    <div class="col-sm-2"><label>Ticket Time</label></div>
                    <div class="col-sm-2"><label>SLAs Met</label></div>
                    <div class="col-sm-2"><label>PTO Time</label></div>
                </div>
                <div class="row">
                    <div class="col-sm-2">
                        <input id="id_administration_time" name="administration_time"
                            {% if automation_data.administration_time %} value="{{ automation_data.administration_time }}" class="gentle" {% else %} value="{{ metric.administration_time }}" {% endif %}>
                    </div>
                    <div class="col-sm-2">
                        <input id="id_project_time" name="project_time"
                            {% if automation_data.project_time %} value="{{ automation_data.project_time }}" class="gentle" {% else %} value="{{ metric.project_time }}" {% endif %}>
                    </div>
					<div class="col-sm-2">
                        <input id="id_ticket_time" name="ticket_time"
                            {% if automation_data.ticket_time %} value="{{ automation_data.ticket_time }}" class="gentle" {% else %} value="{{ metric.ticket_time }}" {% endif %}>
                    </div>
					<div class="col-sm-2">
                        <input id="id_slas_met" name="slas_met"
                            {% if automation_data.slas_met %} value="{{ automation_data.slas_met }}" class="gentle" {% else %} value="{{ metric.slas_met }}" {% endif %}>
                    </div>
                    <div class="col-sm-2">
                        <input id="id_pto_holiday_time" name="pto_holiday_time"
                            {% if automation_data.pto_holiday_time %} value="{{ automation_data.pto_holiday_time }}" class="gentle" {% else %} value="{{ metric.pto_holiday_time }}" {% endif %}>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-2"><label>Utilization</label></div>
                    <div class="col-sm-2"><label>Efficiency</label></div>
                </div>
                <div class="row">
                    <div class="col-sm-2">
                        <input class="gentle" id="id_utilization" title="(Administration Time + Project Time + Ticket Time) / (Staffs * 40 - PTO Holiday Time)"
                           {% if calculate_data %}
                               value="{{ calculate_data.utilization|percentage_format }}"
                           {% else %}
                               value="{{ metric.utilization|percentage_format }}"
                           {% endif %} disabled/>
                    </div>
                    <div class="col-sm-2">
                        <input class="gentle" id="id_efficiency" title="(Administration Time + Project Time + Ticket Time) / (Staffs * 30)"
                           {% if calculate_data %}
                               value="{{ calculate_data.efficiency|percentage_format }}"
                           {% else %}
                               value="{{ metric.efficiency|percentage_format }}"
                           {% endif %} disabled/>
                    </div>
                </div>

                <legend style="margin-top: 30px;">Costs</legend>
                <div class="row">
                    <div class="col-sm-2"><label>Power Consumption UPS A</label></div>
                    <div class="col-sm-2"><label>Power Consumption UPS B</label></div>
                    <div class="col-sm-2"><label>License Cost</label></div>
                </div>
                <div class="row">
                    <div class="col-sm-2">
                        <input id="id_power_consumption_ups_a" name="power_consumption_ups_a"
                            {% if automation_data.power_consumption_ups_a%}
                               value="{{ automation_data.power_consumption_ups_a}}" class="gentle"
                            {% else %}
                               value="{{ metric.power_consumption_ups_a}}"
                            {% endif %}>
                    </div>
                    <div class="col-sm-2">
                        <input id="id_power_consumption_ups_b" name="power_consumption_ups_b"
                            {% if automation_data.power_consumption_ups_b%}
                               value="{{ automation_data.power_consumption_ups_b}}" class="gentle"
                            {% else %}
                               value="{{ metric.power_consumption_ups_b}}"
                            {% endif %}>
                    </div>
                    <div class="col-sm-2">
                        <input id="id_license_cost" name="license_cost"
                            {% if automation_data.license_cost%}
                               value="{{ automation_data.license_cost}}" class="gentle"
                            {% else %}
                               value="{{ metric.license_cost}}"
                            {% endif %}>
                    </div>
                </div>
            {% else %} <!-- For QA, TE, RE, QI -->
                <legend style="margin-top: 30px;">Human Resource</legend>
                <div class="row">
                    <div class="col-sm-2"><label>Staffs</label></div>
                    {% if metric.functional_group.abbreviation in 'QA, TE' %}
                        <div class="col-sm-2"><label>Testers</label></div>
                    {% endif %}
                    <div class="col-sm-2"><label>Openings</label></div>
                    <div class="col-sm-2"><label>Contractors</label></div>
                    <div class="col-sm-2"><label>Compliments</label></div>
                    <div class="col-sm-2"><label>Complaints</label></div>
                </div>
                <div class="row">
                    <div class="col-sm-2">{{ form.staffs }}</div>
                    {% if metric.functional_group.abbreviation in 'QA, TE' %}
                        <div class="col-sm-2">{{ form.testers }}</div>
                    {% endif %}
                    <div class="col-sm-2">{{ form.openings }}</div>
                    <div class="col-sm-2">{{ form.contractors }}</div>
                    <div class="col-sm-2">
                        <input id="id_compliments" name="compliments"
                            {% if automation_data.compliments %} value="{{ automation_data.compliments }}" class="gentle" {% else %} value="{{ metric.compliments }}" {% endif %}>
                    </div>
                    <div class="col-sm-2">
                        <input id="id_complaints" name="complaints"
                            {% if automation_data.complaints %} value="{{ automation_data.complaints }}" class="gentle" {% else %} value="{{ metric.complaints }}" {% endif %}>
                    </div>
                </div>

                <legend style="margin-top: 30px;">Throughput</legend>
                {% if metric.functional_group.abbreviation == 'QE' %}  <!-- Throughput QE -->
                    <div class="row">
                        <div class="col-sm-2"><label>Backlog Story</label></div>
                        <div class="col-sm-2"><label>Story Points Prep</label></div>
                        <div class="col-sm-2"><label>Story Points Execute</label></div>
                        <div class="col-sm-2"><label>Unit Tests Dev</label></div>
                        <div class="col-sm-2"><label>Unit Tests Cover</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">
                            <input id="id_story_points_backlog" name="story_points_backlog"
                                {% if automation_data.story_points_backlog %}
                                   value="{{ automation_data.story_points_backlog }}" class="gentle"
                                {% else %}
                                   value="{{ metric.story_points_backlog }}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">
                            <input id="id_story_points_prep" name="story_points_prep"
                                {% if automation_data.story_points_prep %}
                                   value="{{ automation_data.story_points_prep }}" class="gentle"
                                {% else %}
                                   value="{{ metric.story_points_prep }}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">{{ form.story_points_execution }}</div>
                        <div class="col-sm-2">{{ form.unit_tests_dev }}</div>
                        <div class="col-sm-2">
                            <input id="id_unit_tests_coverage" name="unit_tests_coverage"
                                {% if automation_data.unit_tests_coverage %}
                                   value="{{ automation_data.unit_tests_coverage }}" class="gentle"
                                {% else %}
                                   value="{{ metric.unit_tests_coverage }}"
                                {% endif %}>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2"><label>Defects in Dev</label></div>
                        <div class="col-sm-2"><label>Research Time</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">
                            <input id="id_defects_in_dev" name="defects_in_dev"
                                {% if automation_data.defects_in_dev%}
                                   value="{{ automation_data.defects_in_dev}}" class="gentle"
                                {% else %}
                                   value="{{ metric.defects_in_dev}}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">{{ form.elicitation_analysis_time }}</div>

                    </div>
                {% elif metric.functional_group.abbreviation == 'RE' %}  <!-- Throughput RE -->
                    <div class="row">
                        <div class="col-sm-2"><label>Backlog</label></div>
                        <div class="col-sm-2"><label>Active Projects</label></div>
                        <div class="col-sm-2"><label>Team Initiatives</label></div>
                        <div class="col-sm-2"><label>Elicitation Analysis</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">
                            <input id="id_backlog" name="backlog"
                                {% if automation_data.backlog%}
                                   value="{{ automation_data.backlog}}" class="gentle"
                                {% else %}
                                   value="{{ metric.backlog}}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">
                            <input id="id_active_projects" name="active_projects"
                                {% if automation_data.active_projects%}
                                   value="{{ automation_data.active_projects}}" class="gentle"
                                {% else %}
                                   value="{{ metric.active_projects}}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">
                            <input id="id_team_initiative" name="team_initiative"
                                {% if automation_data.team_initiative %}
                                   value="{{ automation_data.team_initiative }}" class="gentle"
                                {% else %}
                                   value="{{ metric.team_initiative }}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">{{ form.elicitation_analysis_time }}</div>
                    </div>
                {% else %}  <!-- Throughput QA TE -->
                    <div class="row">
                        <div class="col-sm-2"><label>Team Initiatives</label></div>
                        <div class="col-sm-2"><label>Tickets Backlog</label></div>
                        <div class="col-sm-2"><label>Tickets Prep</label></div>
                        <div class="col-sm-2"><label>Tickets Execution</label></div>
                        <div class="col-sm-2"><label>Tickets Closed</label></div>
                        <div class="col-sm-2"><label>Projects Backlog</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">
                            <input id="id_team_initiative" name="team_initiative"
                                {% if automation_data.team_initiative %}
                                   value="{{ automation_data.team_initiative }}" class="gentle"
                                {% else %}
                                   value="{{ metric.team_initiative }}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">
                            <input id="id_ticket_backlog" name="ticket_backlog"
                                {% if automation_data.ticket_backlog%}
                                   value="{{ automation_data.ticket_backlog}}" class="gentle"
                                {% else %}
                                   value="{{ metric.ticket_backlog}}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">
                            <input id="id_ticket_prep" name="ticket_prep"
                                {% if automation_data.ticket_prep%}
                                   value="{{ automation_data.ticket_prep}}" class="gentle"
                                {% else %}
                                   value="{{ metric.ticket_prep}}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">
                            <input id="id_ticket_execution" name="ticket_execution"
                                {% if automation_data.ticket_execution%}
                                   value="{{ automation_data.ticket_execution}}" class="gentle"
                                {% else %}
                                   value="{{ metric.ticket_execution}}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">
                            <input id="id_ticket_closed" name="ticket_closed"
                                {% if automation_data.ticket_closed%}
                                   value="{{ automation_data.ticket_closed}}" class="gentle"
                                {% else %}
                                   value="{{ metric.ticket_closed}}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">
                            <input id="id_project_backlog" name="project_backlog"
                                {% if automation_data.project_backlog%}
                                   value="{{ automation_data.project_backlog}}" class="gentle"
                                {% else %}
                                   value="{{ metric.project_backlog}}"
                                {% endif %}>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2"><label>Projects Prep</label></div>
                        <div class="col-sm-2"><label>Projects Execution</label></div>
                        <div class="col-sm-2"><label>Projects Closed</label></div>
                        <div class="col-sm-2"><label>Manual TCs Dev</label></div>
                        <div class="col-sm-2"><label>Manual TC Dev Time</label></div>
                        <div class="col-sm-2"><label>Manual Tcs Execution</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">
                            <input id="id_project_prep" name="project_prep"
                                {% if automation_data.project_prep%}
                                   value="{{ automation_data.project_prep}}" class="gentle"
                                {% else %}
                                   value="{{ metric.project_prep}}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">
                            <input id="id_project_execution" name="project_execution"
                                {% if automation_data.project_execution%}
                                   value="{{ automation_data.project_execution}}" class="gentle"
                                {% else %}
                                   value="{{ metric.project_execution}}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">
                            <input id="id_project_closed" name="project_closed"
                                {% if automation_data.project_closed%}
                                   value="{{ automation_data.project_closed}}" class="gentle"
                                {% else %}
                                   value="{{ metric.project_closed}}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">{{ form.tc_manual_dev }}</div>
                        <div class="col-sm-2">{{ form.tc_manual_dev_time }}</div>
                        <div class="col-sm-2">{{ form.tc_manual_execution }}</div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2"><label>Auto TCs Dev</label></div>
                        <div class="col-sm-2"><label>Auto TCs Dev Time</label></div>
                        <div class="col-sm-2"><label>Auto Tcs Execution</label></div>
                        <div class="col-sm-2"><label>Auto Tcs ExecTime</label></div>
                        <div class="col-sm-2"><label>Manual Tcs ExecutTime</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">{{ form.tc_auto_dev }}</div>
                        <div class="col-sm-2">{{ form.tc_auto_dev_time }}</div>
                        <div class="col-sm-2">{{ form.tc_auto_execution }}</div>
                        <div class="col-sm-2">{{ form.tc_auto_execution_time }}</div>
                        <div class="col-sm-2">{{ form.tc_manual_execution_time }}</div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2"><label>Estimated Manual Time For Automation</label></div>
                        <div class="col-sm-2"><label>Standard Work Time</label></div>
                        <div class="col-sm-2"><label>Auto Footprint Dev</label></div>
                        <div class="col-sm-2"><label>Auto Footprint Execut</label></div>
                        <div class="col-sm-2"><label>Avg Throughput</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">
                            <input id="id_estimate_auto_time" name="estimate_auto_time"
                               {% if automation_data.estimate_auto_time %}
                                   value="{{ automation_data.estimate_auto_time }}" class="gentle"
                               {% else %}
                                   value="{{ metric.estimate_auto_time }}"
                               {% endif %}/>
                        </div>
						<div class="col-sm-2">
                            <input id="id_standard_work_time" name="standard_work_time"
                               {% if automation_data.standard_work_time %}
                                   value="{{ automation_data.standard_work_time }}" class="gentle"
                               {% else %}
                                   value="{{ metric.standard_work_time }}"
                               {% endif %}/>
                        </div>
                        <div class="col-sm-2">
                            <input class="gentle" id="auto_footprint_dev" title="AutoTCsDev /(ManualTCsDev + AutoTCsDev)"
                               {% if calculate_data %}
                                   value="{{ calculate_data.auto_footprint_dev_age|percentage_format }}"
                               {% else %}
                                   value="{{ metric.auto_footprint_dev_age|percentage_format }}"
                               {% endif %}disabled/>
                        </div>
                        <div class="col-sm-2">
                            <input class="gentle" id="auto_footprint_execution" title="AutoTCsExecution /(ManualTCsExecution + AutoTCsExecution)"
                               {% if calculate_data %}
                                   value="{{ calculate_data.auto_footprint_execution_age|percentage_format}}"
                               {% else %}
                                   value="{{ metric.auto_footprint_execution_age|percentage_format }}"
                               {% endif %} disabled/>
                        </div>
                        <div class="col-sm-2">
                            <input class="gentle" id="avg_throughput" title="(ManualTCsDev + AutoTCsDev + ManualTCsExecution + AutoTCsExecution) / Staffs"
                               {% if calculate_data %}
                                   value="{{ calculate_data.avg_throughput|floatformat:2 }}"
                               {% else %}
                                   value="{{ metric.avg_throughput|floatformat:2 }}"
                               {% endif %} disabled/>
                        </div>
                    </div>
                {% endif %}

                <legend style="margin-top: 30px;">Quality</legend>
                {% if metric.functional_group.abbreviation == 'QE' %}  <!-- Quality QE-->
                    <div class="row">
                        <div class="col-sm-2"><label>SLAs Met</label></div>
                        <div class="col-sm-2"><label>Resource Swap</label></div>
                        <div class="col-sm-2"><label>Escalations</label></div>
                        <div class="col-sm-2"><label>Rework Intro Time</label></div>
                        <div class="col-sm-4"><label>Externally Reported Defects</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">
                            <input id="id_slas_met" name="slas_met"
                                {% if automation_data.slas_met%}
                                   value="{{ automation_data.slas_met}}" class="gentle"
                                {% else %}
                                   value="{{ metric.slas_met}}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">
                            <input id="id_resource_swap" name="resource_swap"
                                {% if automation_data.resource_swap%}
                                   value="{{ automation_data.resource_swap}}" class="gentle"
                                {% else %}
                                   value="{{ metric.resource_swap}}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">
                            <input id="id_escalations" name="escalations"
                                {% if automation_data.escalations%}
                                   value="{{ automation_data.escalations}}" class="gentle"
                                {% else %}
                                   value="{{ metric.escalations}}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">
                            <input id="id_rework_introduced_time" name="rework_introduced_time"
                                {% if automation_data.rework_introduced_time%}
                                   value="{{ automation_data.rework_introduced_time}}" class="gentle"
                                {% else %}
                                   value="{{ metric.rework_introduced_time}}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-4">
                            <input id="id_uat_defects_not_prevented" name="uat_defects_not_prevented"
                                {% if automation_data.uat_defects_not_prevented%}
                                   value="{{ automation_data.uat_defects_not_prevented}}" class="gentle"
                                {% else %}
                                   value="{{ metric.uat_defects_not_prevented}}"
                                {% endif %}>
                        </div>
                    </div>

                {% elif metric.functional_group.abbreviation == 'RE' %}  <!--Quality RE -->
                    <div class="row">
                        <div class="col-sm-2"><label>Revisions</label></div>
                        <div class="col-sm-2"><label>Rework Intro Time</label></div>
                        <div class="col-sm-2"><label>SLAs Met</label></div>
                        <div class="col-sm-2"><label>SLAs Missed</label></div>
                        <div class="col-sm-2"><label>Delays Intro Time</label></div>
                        <div class="col-sm-2"><label>Escalations</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">{{ form.revisions }}</div>
                        <div class="col-sm-2">
                            <input id="id_rework_introduced_time" name="rework_introduced_time"
                                {% if automation_data.rework_introduced_time%}
                                   value="{{ automation_data.rework_introduced_time}}" class="gentle"
                                {% else %}
                                   value="{{ metric.rework_introduced_time}}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">
                            <input id="id_slas_met" name="slas_met"
                                {% if automation_data.slas_met%}
                                   value="{{ automation_data.slas_met}}" class="gentle"
                                {% else %}
                                   value="{{ metric.slas_met}}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">
                            <input id="id_slas_missed" name="slas_missed"
                                {% if automation_data.slas_missed%}
                                   value="{{ automation_data.slas_missed}}" class="gentle"
                                {% else %}
                                   value="{{ metric.slas_missed}}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">
                            <input id="id_delays_introduced_time" name="delays_introduced_time"
                                {% if automation_data.delays_introduced_time%}
                                   value="{{ automation_data.delays_introduced_time}}" class="gentle"
                                {% else %}
                                   value="{{ metric.delays_introduced_time}}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">{{ form.escalations }}</div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2"><label>Avg Throughput</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">
                            <input class="gentle" id="avg_throughput" title="ActiveProjects + TeamInitiatives"
                                   value="{{ metric.avg_throughput|floatformat:2 }}" disabled/>
                        </div>
                    </div>
                {% else %}  <!--Quality QA, TE -->
                    <div class="row">
                        <div class="col-sm-2"><label>SLAs Met</label></div>
                        <div class="col-sm-2"><label>LOE Deviation Time</label></div>
                        <div class="col-sm-2"><label>Defects Caught</label></div>
                        <div class="col-sm-3"><label>UAT defects not prevented</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">
                            <input id="id_slas_met" name="slas_met"
                                {% if automation_data.slas_met%}
                                   value="{{ automation_data.slas_met}}" class="gentle"
                                {% else %}
                                   value="{{ metric.slas_met}}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">
                            <input id="id_loe_deviation" name="loe_deviation"
                                {% if automation_data.loe_deviation%}
                                   value="{{ automation_data.loe_deviation}}" class="gentle"
                                {% else %}
                                   value="{{ metric.loe_deviation}}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">{{ form.defect_caught }}</div>
                        <div class="col-sm-3">{{ form.uat_defects_not_prevented }}</div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2"><label>SDIs not prevented</label></div>
                        <div class="col-sm-2"><label>Resource Swap</label></div>
                        <div class="col-sm-2"><label>Escalations</label></div>
                        <div class="col-sm-2"><label>Standards Violated</label></div>
                        <div class="col-sm-2"><label>Rework Intro Time</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">
                            <input id="id_sdis_not_prevented" name="sdis_not_prevented"
                                {% if automation_data.sdis_not_prevented%}
                                   value="{{ automation_data.sdis_not_prevented}}" class="gentle"
                                {% else %}
                                   value="{{ metric.sdis_not_prevented}}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">
                            <input id="id_resource_swap" name="resource_swap"
                                {% if automation_data.resource_swap%}
                                   value="{{ automation_data.resource_swap}}" class="gentle"
                                {% else %}
                                   value="{{ metric.resource_swap}}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">
                            <input id="id_escalations" name="escalations"
                                {% if automation_data.escalations%}
                                   value="{{ automation_data.escalations}}" class="gentle"
                                {% else %}
                                   value="{{ metric.escalations}}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">{{ form.standards_violated }}</div>
                        <div class="col-sm-2">
                            <input id="id_rework_introduced_time" name="rework_introduced_time"
                                {% if automation_data.rework_introduced_time%}
                                   value="{{ automation_data.rework_introduced_time}}" class="gentle"
                                {% else %}
                                   value="{{ metric.rework_introduced_time}}"
                                {% endif %}>
                        </div>
                    </div>
                {% endif %}

                <legend style="margin-top: 30px;">Efficiency</legend>
                {% if metric.functional_group.abbreviation == 'QE' %}  <!-- Efficiency -->
                    <div class="row">
                        <div class="col-sm-2"><label>Overtime Weekday</label></div>
                        <div class="col-sm-2"><label>Overtime Weekend</label></div>
                        <div class="col-sm-2"><label>Average Throughput</label></div>
                        <div class="col-sm-2"><label>Rework Time</label></div>
                        <div class="col-sm-2"><label>Resource Swap time</label></div>
                        <div class="col-sm-2"><label>PTO Time</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">{{ form.overtime_weekday }}</div>
                        <div class="col-sm-2">{{ form.overtime_weekend }}</div>
                        <div class="col-sm-2">
                            <input class="gentle" id="avg_throughput_qi" title="StoryPointsExecution / Staffs"
                                {% if calculate_data %}
                                   value="{{ calculate_data.avg_throughput|floatformat:2 }}"
                                {% else %}
                                   value="{{ metric.avg_throughput|floatformat:2 }}"
                                {% endif %} disabled/>
                        </div>
                        <div class="col-sm-2">{{ form.rework_time }}</div>
                        <div class="col-sm-2">
                            <input id="id_resource_swap_time" name="resource_swap_time"
                                {% if automation_data.resource_swap_time%}
                                   value="{{ automation_data.resource_swap_time}}" class="gentle"
                                {% else %}
                                   value="{{ metric.resource_swap_time}}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">
                            <input id="id_pto_holiday_time" name="pto_holiday_time"
                                {% if automation_data.pto_holiday_time%}
                                   value="{{ automation_data.pto_holiday_time}}" class="gentle"
                                {% else %}
                                   value="{{ metric.pto_holiday_time}}"
                                {% endif %}>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2"><label>Customer Facing Time</label></div>
                        <div class="col-sm-2"><label>Documentation Time</label></div>
                        <div class="col-sm-2"><label>Ticketless Dev Time</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">
                            <input id="id_customer_facing_time" name="customer_facing_time"
                                {% if automation_data.customer_facing_time%}
                                   value="{{ automation_data.customer_facing_time}}" class="gentle"
                                {% else %}
                                   value="{{ metric.customer_facing_time}}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">
                            <input id="id_documentation_time" name="documentation_time"
                                {% if automation_data.documentation_time%}
                                   value="{{ automation_data.documentation_time}}" class="gentle"
                                {% else %}
                                   value="{{ metric.documentation_time}}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">
                            <input id="id_ticketless_dev_time" name="ticketless_dev_time"
                                {% if automation_data.dticketless_dev_time%}
                                   value="{{ automation_data.ticketless_dev_time}}" class="gentle"
                                {% else %}
                                   value="{{ metric.ticketless_dev_time}}"
                                {% endif %}>
                        </div>
                    </div>
                {% elif metric.functional_group.abbreviation == 'RE' %}
                    <div class="row">
                        <div class="col-sm-2"><label>Gross Available</label></div>
                        <div class="col-sm-2"><label>Efficiency</label></div>
                        <div class="col-sm-2"><label>Overtime Weekday</label></div>
                        <div class="col-sm-2"><label>Overtime Weekend</label></div>
                        <div class="col-sm-2"><label>Rework External</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">
                            <input class="gentle" id="gross_available" title="Staffs * 30"
                                {% if calculate_data %}
                                   value="{{ calculate_data.gross_available_time|floatformat:2 }}"
                                {% else %}
                                   value="{{ metric.gross_available_time|floatformat:2 }}"
                                {% endif %}disabled/>
                        </div>
                        <div class="col-sm-2">
                            <input class="gentle" id="id_efficiency" title="ElicitationAnalysis / GrossAvailable"
                                {% if calculate_data %}
                                   value="{{ calculate_data.efficiency|percentage_format }}"
                                {% else %}
                                   value="{{ metric.efficiency|percentage_format }}"
                                {% endif %} disabled/>
                        </div>
                        <div class="col-sm-2">{{ form.overtime_weekday }}</div>
                        <div class="col-sm-2">{{ form.overtime_weekend }}</div>
                        <div class="col-sm-2">{{ form.rework_external_time }}</div>
                    </div>
                {% else %}  <!--Efficiency QA, TE -->
                    <div class="row">
                        <div class="col-sm-2"><label>Overtime Weekday</label></div>
                        <div class="col-sm-2"><label>Overtime Weekend</label></div>
                        <div class="col-sm-2"><label>Rework Time</label></div>
                        <div class="col-sm-2"><label>Resource Swap time</label></div>
                        <div class="col-sm-2"><label>PTO Time</label></div>
                        <div class="col-sm-2"><label>Productive Time</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">{{ form.overtime_weekday }}</div>
                        <div class="col-sm-2">{{ form.overtime_weekend }}</div>
                        <div class="col-sm-2">{{ form.rework_time }}</div>
                        <div class="col-sm-2">{{ form.resource_swap_time }}</div>
                        <div class="col-sm-2">{{ form.pto_holiday_time }}</div>
                        <div class="col-sm-2">
                            <input class="gentle" id="productive_hours" title="AutoExec Time + Standard Work Time"
                                   value="{{ metric.productive_hours }}" disabled/>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm-2"><label>Active Tickets</label></div>
                        <div class="col-sm-2"><label>Active Projects</label></div>
                        <div class="col-sm-2"><label>AutoExec Time</label></div>
                        <div class="col-sm-2"><label>GrossAvailable time</label></div>
                        <div class="col-sm-2"><label>Efficiency</label></div>
                        <div class="col-sm-2"><label>Utilization</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">
                            <input class="gentle" id="active_tickets" title="TicketsPrep + TicketsExecution"
                                   value="{{ metric.active_tickets }}" disabled/>
                        </div>
                        <div class="col-sm-2">
                            <input class="gentle" id="active_projects" title="ProjectsPrep + ProjectsExecution"
                                   value="{{ metric.active_projects }}" disabled/>
                        </div>
                        <div class="col-sm-2">
                            <input class="gentle" id="auto_and_execution_time" title="ManualTCsDevTime + ManualTCsExecutionTime + AutoTCsDevTime + AutoTCsExecutionTime"
                               {% if calculate_data %}
                                   value="{{ calculate_data.auto_and_execution_time|floatformat:2 }}"
                               {% else %}
                                   value="{{ metric.auto_and_execution_time|floatformat:2 }}"
                               {% endif %} disabled/>
                        </div>
                        <div class="col-sm-2">
                            <input class="gentle" id="gross_available_time" title="Testers * 30"
                                   value="{{ metric.gross_available_time }}" disabled/>
                        </div>
                        <div class="col-sm-2">
                            <input class="gentle" id="id_test_efficiency" title="AutoExecTime / GrossAvaiTime"
                                   value="{{ metric.efficiency|percentage_format }}" disabled/>
                        </div>
                        <div class="col-sm-2">
                            <input class="gentle" id="id_test_utilization" title="Productive Time / (Testers * 40 - PTO Time)"
                               value="{{ metric.utilization|percentage_format }}" disabled/>
                        </div>
                    </div>
                {% endif %}

                <legend style="margin-top: 30px;">Costs</legend>
                {% if metric.functional_group.abbreviation == 'RE' %} <!-- Cost and Usage-->
                    <div class="row">
                        <div class="col-sm-2"><label>Travel Cost</label></div>
                        <div class="col-sm-2"><label>Operational Cost</label></div>
                        <div class="col-sm-2"><label>Rework External Cost</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">{{ form.travel_cost }}</div>
                        <div class="col-sm-2">
                            <input class="gentle" id="operational_cost" title="(Staffs + Contractors) * 30 * 50"
                                {% if calculate_data %}
                                   value="{{ calculate_data.operational_cost|floatformat:2 }}"
                                {% else %}
                                   value="{{ metric.operational_cost|floatformat:2 }}"
                                {% endif %} disabled/>
                        </div>
                        <div class="col-sm-2">
                            <input class="gentle" id="rework_external_cost" title="ReworkExternal * 50"
                                {% if calculate_data %}
                                   value="{{ calculate_data.rework_external_cost|floatformat:2 }}"
                                {% else %}
                                   value="{{ metric.rework_external_cost|floatformat:2 }}"
                                {% endif %} disabled/>
                        </div>
                    </div>
                {% elif metric.functional_group.abbreviation == 'QE' %} <!-- QI Cost and Usage -->
                    <div class="row">
                        <div class="col-sm-2"><label>License Cost</label></div>
                        <div class="col-sm-2"><label>Operational Cost</label></div>
                        <div class="col-sm-2"><label>Total Cost</label></div>
                        <div class="col-sm-2"><label>Other Savings</label></div>
                        <div class="col-sm-2"><label>External Savings</label></div>
                        <div class="col-sm-2"><label>Internal Savings</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">
                            <input id="id_license_cost" name="license_cost"
                                {% if automation_data.license_cost%}
                                   value="{{ automation_data.license_cost}}" class="gentle"
                                {% else %}
                                   value="{{ metric.license_cost}}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">
                            <input class="gentle" id="operational_cost" title="(Staffs + Contractors) * 40 * 45"
                                {% if calculate_data %}
                                   value="{{ calculate_data.operational_cost|floatformat:2 }}"
                                {% else %}
                                   value="{{ metric.operational_cost|floatformat:2 }}"
                                {% endif %} disabled/>
                        </div>
                        <div class="col-sm-2">
                            <input class="gentle" id="total_cost" title="LicenseCost + OperationalCost"
                                {% if calculate_data %}
                                   value="{{ calculate_data.total_cost|floatformat:2 }}"
                                {% else %}
                                   value="{{ metric.total_operational_cost }}"
                                {% endif %}disabled />
                        </div>
                        <div class="col-sm-2">
                            <input id="id_other_savings" name="other_savings"
                                {% if automation_data.other_savings%}
                                   value="{{ automation_data.other_savings}}" class="gentle"
                                {% else %}
                                   value="{{ metric.other_savings}}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">
                            <input class="gentle" id="external_savings" title="Visilog Parsed * .33 + Pheme Manual * 1.79 + Pheme Auto * 1.97"
                                {% if calculate_data %}
                                   value="{{ calculate_data.external_savings|floatformat:2 }}"
                                {% else %}
                                   value="{{ metric.external_savings }}"
                                {% endif %}disabled />
                        </div>
                        <div class="col-sm-2">
                            <input class="gentle" id="internal_savings" title="Ceeq * 20 + Other Savings"
                                {% if calculate_data %}
                                   value="{{ calculate_data.internal_savings|floatformat:2 }}"
                                {% else %}
                                   value="{{ metric.internal_savings }}"
                                {% endif %}disabled />
                        </div>
                    </div>
                    <!-- Usage -->
                    <legend style="margin-top: 30px;">Usage</legend>
                    <div class="row">
                        <div class="col-sm-2"><label>Pheme Manual Tests</label></div>
                        <div class="col-sm-2"><label>Pheme Auto Tests</label></div>
                        <div class="col-sm-2"><label>Visilog TXL Parsed</label></div>
                        <div class="col-sm-2"><label>Visilog TXL Violation</label></div>
                        <div class="col-sm-2"><label>CEEQ Daily Summaries</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">
                            <input id="id_pheme_manual_tests" name="pheme_manual_tests"
                                {% if automation_data.pheme_manual_tests%}
                                   value="{{ automation_data.pheme_manual_tests}}" class="gentle"
                                {% else %}
                                   value="{{ metric.pheme_manual_tests}}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">
                            <input id="id_pheme_auto_tests" name="pheme_auto_tests"
                                {% if automation_data.pheme_auto_tests%}
                                   value="{{ automation_data.pheme_auto_tests}}" class="gentle"
                                {% else %}
                                   value="{{ metric.pheme_auto_tests}}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">
                            <input id="id_visilog_txl_parsed" name="visilog_txl_parsed"
                                {% if automation_data.visilog_txl_parsed%}
                                   value="{{ automation_data.visilog_txl_parsed}}" class="gentle"
                                {% else %}
                                   value="{{ metric.visilog_txl_parsed}}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">
                            <input id="id_visilog_txl_schema_violation" name="visilog_txl_schema_violation"
                                {% if automation_data.visilog_txl_schema_violation%}
                                   value="{{ automation_data.visilog_txl_schema_violation}}" class="gentle"
                                {% else %}
                                   value="{{ metric.visilog_txl_schema_violation}}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">
                            <input id="id_ceeq_daily_summaries" name="ceeq_daily_summaries"
                                {% if automation_data.ceeq_daily_summaries%}
                                   value="{{ automation_data.ceeq_daily_summaries}}" class="gentle"
                                {% else %}
                                   value="{{ metric.ceeq_daily_summaries}}"
                                {% endif %}>
                        </div>
                    </div>
                {% else %} <!-- QA, TE cost -->
                    <div class="row">
                        <div class="col-sm-2"><label>License Cost</label></div>
                        <div class="col-sm-2"><label>Operational Cost</label></div>
                        <div class="col-sm-2"><label>Total Cost</label></div>
                        <div class="col-sm-2"><label>Automation Savings</label></div>
                        <div class="col-sm-2"><label>Other Savings</label></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">
                            <input id="id_license_cost" name="license_cost"
                                {% if automation_data.license_cost%}
                                   value="{{ automation_data.license_cost}}" class="gentle"
                                {% else %}
                                   value="{{ metric.license_cost}}"
                                {% endif %}>
                        </div>
                        <div class="col-sm-2">
                            <input class="gentle" id="operational_cost" title="Staffs * HoursPerWeek * CostsPerHourPerStaff + Contractors * HoursPerWeek * CostsPerHourPerContractor"
                                {% if calculate_data %}
                                   value="{{ calculate_data.operational_cost|floatformat:2 }}"
                                {% else %}
                                   value="{{ metric.operational_cost|floatformat:2 }}"
                                {% endif %} disabled/>
                        </div>
                        <div class="col-sm-2">
                            <input class="gentle" id="total_cost" title="LicenseCost + OperationalCost"
                                {% if calculate_data %}
                                   value="{{ calculate_data.total_cost|floatformat:2 }}"
                                {% else %}
                                   value="{{ metric.total_operational_cost }}"
                                {% endif %}disabled />
                        </div>
                        <div class="col-sm-2">
                            <input class="gentle" id="auto_savings" title="(Estimated Manual Time for Automation- AutoExecTime) * CostPerHourPerStaff"
                                value="{{ metric.auto_savings }}" disabled />
                        </div>
                        <div class="col-sm-2">
                            <input id="id_other_savings" name="other_savings"
                                {% if automation_data.other_savings%}
                                   value="{{ automation_data.other_savings}}" class="gentle"
                                {% else %}
                                   value="{{ metric.other_savings}}"
                                {% endif %}>
                        </div>
                    </div>
                {% endif %}
            {% endif %}


            {% csrf_token %}
            {% if metric.subteam %}
                <div class="row" style="margin-top: 30px; margin-bottom: 50px;">
                    <div class="col-md-4"></div>
                    <div class="col-md-2">
                        <input id="qi_edit" class="btn btn-primary" style="width: 100%;" type="submit" value="Save Metric">
                    </div>
                    <div class="col-md-2">
                        <a href="{% url 'teams:teams' %}" class="btn btn-default" style="width: 100%;">Cancel</a>
                    </div>
                </div>
            {% endif %}
        </form>
    </div>
    {% include 'teams/teams_modal.html' %}
{% endblock %}

{% block footer %}
    <script>
        {% include 'teams/metric_detail.js' %}
    </script>
{% endblock %}